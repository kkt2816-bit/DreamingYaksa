<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ë¬´ë£Œ ê±´ê°• ì²´í¬</title>
  <style>
    :root { --bg:#0b0f19; --card:#111827; --muted:#9ca3af; --text:#e5e7eb; --accent:#22c55e; --accent2:#60a5fa; --danger:#f87171; }
    * { box-sizing: border-box; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo", "Noto Sans KR", Arial, sans-serif; background: var(--bg); color: var(--text); }
    .wrap { max-width: 920px; margin: 0 auto; padding: 22px 16px 60px; }
    .card { background: var(--card); border: 1px solid #263042; border-radius: 16px; padding: 18px; box-shadow: 0 10px 30px rgba(0,0,0,.25); }
    h1 { margin: 0 0 8px; font-size: 22px; }
    h2 { margin: 0 0 10px; font-size: 18px; }
    p { margin: 8px 0; color: var(--muted); line-height: 1.55; }
    label { display:block; font-size: 13px; color: var(--muted); margin: 0 0 6px; }
    input, select, textarea {
      width: 100%; padding: 12px 12px; border-radius: 12px;
      border: 1px solid #2b364b; background: rgba(3,7,18,0.35); color: var(--text); outline: none;
    }
    input:focus, select:focus, textarea:focus { border-color: rgba(34,197,94,.7); box-shadow: 0 0 0 4px rgba(34,197,94,.12); }

    .grid2 { display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    @media (max-width: 760px){ .grid2 { grid-template-columns: 1fr; } }

    .btn {
      border: 1px solid #2b364b; background: rgba(17,24,39,0.65); color: var(--text);
      padding: 12px 14px; border-radius: 12px; cursor: pointer; font-weight: 800;
      text-decoration:none; display:inline-flex; justify-content:center; align-items:center; text-align:center;
    }
    .btn.primary { border-color: rgba(34,197,94,.55); background: rgba(34,197,94,.12); }
    .btn.primary:hover { background: rgba(34,197,94,.18); }
    .btn.secondary { border-color: rgba(96,165,250,.55); background: rgba(96,165,250,.12); }
    .btn.secondary:hover { background: rgba(96,165,250,.18); }
    .btn.ghost { background: transparent; color: var(--muted); }
    .btn.small { padding: 9px 10px; font-size: 12px; border-radius: 10px; }

    .nav { display:flex; gap:10px; justify-content: space-between; align-items:center; flex-wrap: wrap; margin-top: 14px; }
    .right { margin-left:auto; display:flex; gap:10px; }

    .q { border: 1px solid #263042; border-radius: 14px; padding: 12px; background: rgba(3,7,18,0.25); }
    .q-title { font-size: 15px; margin: 0 0 10px; line-height: 1.45; }
    .yn { display:flex; gap:10px; }
    .yn .btn { flex: 1; }
    .selected-yes { border-color: rgba(34,197,94,.85) !important; background: rgba(34,197,94,.22) !important; }
    .selected-no  { border-color: rgba(156,163,175,.55) !important; background: rgba(156,163,175,.12) !important; color:#d1d5db !important; }

    .error { color: var(--danger); font-size: 13px; margin-top: 8px; display:none; }
    .hint { font-size: 12px; color: var(--muted); line-height: 1.55; }

    .divider { height: 1px; background: #263042; margin: 14px 0; }

    .result-box { border: 1px solid #263042; border-radius: 14px; padding: 14px; background: rgba(3,7,18,0.25); }
    .result-title { font-size: 18px; font-weight: 900; margin:0 0 8px; }

    .tag { display:inline-flex; gap:8px; align-items:center; font-size: 12px; padding: 6px 10px; border-radius: 999px; border: 1px solid #2b364b; color:#d1d5db; margin: 6px 6px 0 0; }
    .tag strong { color: var(--text); }

    .cta { display:grid; gap: 10px; margin-top: 14px; }
    textarea.copybox { min-height: 120px; resize: vertical; }

    .section-title { font-weight: 900; margin: 0 0 8px; }
    .big { font-size: 16px; color: var(--text); line-height: 1.6; }
  </style>
</head>

<body>
<div class="wrap">

  <!-- STEP 1 -->
  <div class="card" id="screenInfo">
    <h1>ë¬´ë£Œ ê±´ê°• ì²´í¬</h1>
    <p>ì•„ë˜ ì •ë³´ë¥¼ ì…ë ¥í•œ ë’¤ ì²´í¬ë¥¼ ì§„í–‰í•´ì£¼ì„¸ìš”. (ê²°ê³¼ëŠ” ì°¸ê³ ìš©)</p>

    <div class="grid2">
      <div>
        <label for="name">ì„±í•¨ (í•„ìˆ˜)</label>
        <input id="name" type="text" placeholder="ì˜ˆ: í™ê¸¸ë™" autocomplete="name" />
        <div class="error" id="errName">ì„±í•¨ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
      </div>
      <div>
        <label for="phone">ì—°ë½ì²˜ (í•„ìˆ˜)</label>
        <input id="phone" type="tel" placeholder="ì˜ˆ: 01012345678" autocomplete="tel" />
        <div class="error" id="errPhone">ì—°ë½ì²˜ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”. (ìˆ«ìë§Œ)</div>
      </div>
    </div>

    <div class="grid2" style="margin-top:12px;">
      <div>
        <label for="gender">ì„±ë³„ (ì„ íƒ)</label>
        <select id="gender">
          <option value="">ì„ íƒ ì•ˆ í•¨</option>
          <option value="ë‚¨">ë‚¨</option>
          <option value="ì—¬">ì—¬</option>
          <option value="ê¸°íƒ€/ì‘ë‹µì•ˆí•¨">ê¸°íƒ€/ì‘ë‹µì•ˆí•¨</option>
        </select>
      </div>
      <div>
        <label for="age">ë‚˜ì´ëŒ€ (ì„ íƒ)</label>
        <select id="age">
          <option value="">ì„ íƒ ì•ˆ í•¨</option>
          <option value="20ëŒ€">20ëŒ€</option>
          <option value="30ëŒ€">30ëŒ€</option>
          <option value="40ëŒ€">40ëŒ€</option>
          <option value="50ëŒ€">50ëŒ€</option>
          <option value="60ëŒ€ ì´ìƒ">60ëŒ€ ì´ìƒ</option>
        </select>
      </div>
    </div>

    <div class="nav">
      <div></div>
      <div class="right">
        <button class="btn primary" id="startBtn">ì²´í¬ ì‹œì‘</button>
      </div>
    </div>

    <p class="hint">â€» ì…ë ¥ ì •ë³´ëŠ” ìƒë‹´ ì—°ê²° ë° ê²°ê³¼ ì €ì¥ ëª©ì ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>
  </div>

  <!-- STEP 2 -->
  <div class="card" id="screenQuestions" style="display:none;">
    <h2>ì²´í¬ ë¬¸í•­ (ì˜ˆ/ì•„ë‹ˆì˜¤)</h2>
    <p class="hint">ìµœê·¼ 2â€“4ì£¼ ê¸°ì¤€ìœ¼ë¡œ ë‹µí•´ì£¼ì„¸ìš”.</p>

    <div id="qList" style="display:grid; gap:12px;"></div>
    <div class="error" id="errUnanswered">ë‹µí•˜ì§€ ì•Šì€ ë¬¸í•­ì´ ìˆìŠµë‹ˆë‹¤. ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.</div>

    <div class="nav">
      <button class="btn ghost" id="backBtn">â† ì´ì „</button>
      <div class="right">
        <button class="btn primary" id="resultBtn">ê²°ê³¼ ë³´ê¸°</button>
      </div>
    </div>
  </div>

  <!-- STEP 3 -->
  <div class="card" id="screenResult" style="display:none;">
    <h1>ê²°ê³¼</h1>
    <p class="hint">ì´ ê²°ê³¼ëŠ” ì§„ë‹¨ì´ ì•„ë‹ˆë¼, í˜„ì¬ ìƒíƒœë¥¼ ì´í•´í•˜ê¸° ìœ„í•œ ì°¸ê³  ìë£Œì…ë‹ˆë‹¤.</p>

    <div class="result-box">
      <div class="result-title" id="mainTypeTitle">ë‚´ ìƒíƒœ ìš”ì•½</div>

      <!-- ì„¤ëª… -->
      <div id="typeExplain" class="big"></div>

      <div class="divider"></div>

      <!-- ì ìˆ˜ -->
      <div class="section-title">ğŸ“Œ ë‚´ ì ìˆ˜ í•œëˆˆì— ë³´ê¸°</div>
      <div id="scoreSummary" class="hint" style="margin-top:6px;"></div>
      <div id="scoreBars" style="display:grid; gap:10px; margin-top:10px;"></div>

      <div class="divider"></div>

      <!-- ê³µê° -->
      <div class="section-title">ğŸ¤ ê³µê°</div>
      <div id="typeEmpathy" class="big"></div>

      <div class="divider"></div>

      <!-- ê¶ê¸ˆì¦ -->
      <div class="section-title">â“ ê¶ê¸ˆì¦</div>
      <div id="typeCuriosity" class="big"></div>

      <div class="divider"></div>

      <!-- ë ˆì´ì–´ -->
      <div class="section-title">âœ… ì¶”ê°€ í™•ì¸(ì°¸ê³ )</div>
      <div class="hint" style="margin-top:6px;">ì•„ë˜ëŠ” â€œì™œ ì´ëŸ° ë¶ˆí¸ì´ ë°˜ë³µë  ìˆ˜ ìˆëŠ”ì§€â€ë¥¼ ë” ì´í•´í•˜ê¸° ìœ„í•œ íŒíŠ¸ì˜ˆìš”.</div>
      <div id="layerTags"></div>

      <div class="divider"></div>
      <div id="layerDetails"></div>
    </div>

    <div class="divider"></div>

    <!-- ìƒë‹´ ì•ˆë‚´ + ë²„íŠ¼ -->
    <div class="result-box">
      <h2 style="margin:0 0 6px;">ìƒë‹´ ì•ˆë‚´</h2>

      <div class="big" style="margin-top:6px;">
        ì´ ì²´í¬ëŠ” <b>ë°©í–¥ì„ ì¡ê¸° ìœ„í•œ ì°¸ê³ ìš©</b>ì´ì—ìš”.<br/>
        ëª‡ ê°€ì§€ë§Œ ë” í™•ì¸í•˜ë©´ <b>ì§€ê¸ˆ ë‚´ ìƒíƒœì— ë§ëŠ” ìˆœì„œ</b>ë¥¼ ë” ì •í™•íˆ ì •ë¦¬í•  ìˆ˜ ìˆì–´ìš”.
      </div>

      <p class="hint" style="margin-top:10px;">
        âœ… ì „í™” ìƒë‹´(ì•½ 20ë¶„) Â· ì›”/í™”/ëª©/ê¸ˆ <b>ì €ë…</b> 8â€“10ì‹œ Â· ë¬´ë£Œ
      </p>

      <div class="divider"></div>

      <label for="copyText">ìƒë‹´ ìš”ì²­ ì‹œ ì•„ë˜ ë‚´ìš©ì„ ë³µì‚¬í•´ì„œ ì¹´í†¡(ë˜ëŠ” ë¬¸ì)ì— ë¶™ì—¬ë„£ì–´ ì£¼ì„¸ìš”</label>
      <textarea id="copyText" class="copybox" readonly></textarea>

      <div class="nav">
        <div style="display:flex; gap:10px;">
          <button class="btn small secondary" id="copyBtn">ë³µì‚¬í•˜ê¸°</button>
          <button class="btn small ghost" id="restartBtn">ì²˜ìŒë¶€í„° ë‹¤ì‹œ</button>
        </div>
      </div>

      <div class="cta">
        <a class="btn primary" id="kakaoBtn" href="https://pf.kakao.com/_xalLwG/chat" target="_blank" rel="noopener">
          ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ìƒë‹´ ì‹ ì²­í•˜ê¸°
        </a>
        <a class="btn secondary" id="smsBtn" href="sms:01024885195?body=ìƒë‹´ìš”ì²­">
          ë¬¸ìë¡œ â€œìƒë‹´ìš”ì²­â€ ë³´ë‚´ê¸°
        </a>
        <div class="hint">
          â€» PCì—ì„œëŠ” â€˜ë¬¸ì ë³´ë‚´ê¸°â€™ê°€ ì‘ë™í•˜ì§€ ì•Šì„ ìˆ˜ ìˆì–´ìš”.<br/>
          ê·¸ëŸ´ ë•ŒëŠ” <b>010-2488-5195</b>ë¡œ â€œìƒë‹´ìš”ì²­â€ ë¬¸ì ì£¼ì„¸ìš”.
        </div>
      </div>
    </div>

    <p class="hint" id="saveHint" style="margin-top:12px;"></p>
  </div>

</div>

<script>
(() => {
  const WEBHOOK_URL = "https://script.google.com/macros/s/AKfycby1inKa5TkO0dgk2LPrUR9ouzO6ft4shqWrMX1I4deJPEmDFRo89ZI9dFqWV21HBx7g/exec";

  // DOM
  const screenInfo = document.getElementById("screenInfo");
  const screenQuestions = document.getElementById("screenQuestions");
  const screenResult = document.getElementById("screenResult");

  const nameEl = document.getElementById("name");
  const phoneEl = document.getElementById("phone");
  const genderEl = document.getElementById("gender");
  const ageEl = document.getElementById("age");
  const errName = document.getElementById("errName");
  const errPhone = document.getElementById("errPhone");

  const startBtn = document.getElementById("startBtn");
  const backBtn = document.getElementById("backBtn");
  const resultBtn = document.getElementById("resultBtn");

  const qList = document.getElementById("qList");
  const errUnanswered = document.getElementById("errUnanswered");

  const mainTypeTitle = document.getElementById("mainTypeTitle");
  const typeExplain = document.getElementById("typeExplain");
  const typeEmpathy = document.getElementById("typeEmpathy");
  const typeCuriosity = document.getElementById("typeCuriosity");

  const layerTags = document.getElementById("layerTags");
  const layerDetails = document.getElementById("layerDetails");

  const copyText = document.getElementById("copyText");
  const copyBtn = document.getElementById("copyBtn");
  const restartBtn = document.getElementById("restartBtn");
  const saveHint = document.getElementById("saveHint");

  // ìƒíƒœ
  const answers = new Map(); // id -> true/false
  let userInfo = {};

  function show(which){
    screenInfo.style.display = "none";
    screenQuestions.style.display = "none";
    screenResult.style.display = "none";
    which.style.display = "block";
    window.scrollTo({ top: 0, behavior: "smooth" });
  }

  function onlyDigits(str){ return (str || "").replace(/\D/g, ""); }

  function validateInfo(){
    const name = (nameEl.value || "").trim();
    const phoneRaw = onlyDigits(phoneEl.value);

    let ok = true;

    if(!name){ errName.style.display="block"; ok = false; }
    else errName.style.display="none";

    const validPhone = phoneRaw.length >= 10 && phoneRaw.length <= 11;
    if(!validPhone){ errPhone.style.display="block"; ok = false; }
    else errPhone.style.display="none";

    if(ok){
      userInfo = {
        name,
        phone: phoneRaw,
        gender: genderEl.value || "",
        age: ageEl.value || ""
      };
    }
    return ok;
  }

  // ì§ˆë¬¸(íƒ€ì…8 + ë ˆì´ì–´16 = 24)
  const questions = [
    // íƒ€ì…
    { id:"T1", text:"ë°°ë³€ì´ ë§¤ì¼ ì¼ì •í•˜ì§€ ì•Šê±°ë‚˜, ë³€ë¹„Â·ì„¤ì‚¬ê°€ ë°˜ë³µë˜ëŠ” í¸ì¸ê°€ìš”?", typeKey:"B" },
    { id:"T2", text:"í™”ì¥ì‹¤ì„ ë‹¤ë…€ì™€ë„ ê°œìš´í•˜ì§€ ì•Šê±°ë‚˜, ì”ë³€ê°ì´ ìì£¼ ìˆë‚˜ìš”?", typeKey:"B" },
    { id:"T3", text:"ê°€ìŠ¤Â·ë³µë¶€ íŒ½ë§Œ ë•Œë¬¸ì— ë¶ˆí¸í•¨ì„ ëŠë¼ëŠ” ë‚ ì´ ìì£¼ ìˆë‚˜ìš”?", typeKey:"B" },

    { id:"T4", text:"ì¡°ê¸ˆë§Œ ë¨¹ì–´ë„ ë”ë¶€ë£©í•˜ê±°ë‚˜, ì²´í•œ ëŠë‚Œì´ ì˜¤ë˜ ê°€ëŠ” í¸ì¸ê°€ìš”?", typeKey:"A" },
    { id:"T5", text:"ì‹ì‚¬ ì§í›„ì— ê°€ì¥ ë¶ˆí¸í•˜ê³ , ì‹œê°„ì´ ì§€ë‚˜ë©´ ìƒëŒ€ì ìœ¼ë¡œ ë‚˜ì•„ì§€ë‚˜ìš”?", typeKey:"A" },
    { id:"T6", text:"ê³µë³µì—ëŠ” ê´œì°®ì€ë°, ì‹ì‚¬ í›„ì— ì† ë¶ˆí¸ê°ì´ ë°˜ë³µë˜ë‚˜ìš”?", typeKey:"A" },

    { id:"T7", text:"ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ë°›ê±°ë‚˜ ê¸´ì¥í•˜ë©´, ì¥ì´ë‚˜ ìœ„ ì¦ìƒì´ ë°”ë¡œ ì˜í–¥ì„ ë°›ë‚˜ìš”?", typeKey:"C" },
    { id:"T8", text:"ì¤‘ìš”í•œ ì¼ì •ì´ë‚˜ ì™¸ì¶œ ì „, í™”ì¥ì‹¤ì´ë‚˜ ì† ìƒíƒœê°€ ìœ ë‚œíˆ ì‹ ê²½ ì“°ì´ë‚˜ìš”?", typeKey:"C" },

    // ë ˆì´ì–´ L1 ì¥ë‚´í™˜ê²½
    { id:"L1_1", text:"ìœ ì‚°ê· ì„ ë¨¹ì„ ë•ŒëŠ” ê´œì°®ë‹¤ê°€, ì¤‘ë‹¨í•˜ë©´ ë‹¤ì‹œ ë¶ˆí¸í•´ì§€ëŠ” í¸ì¸ê°€ìš”?", layerKey:"L1" },
    { id:"L1_2", text:"ë³€ë¹„Â·ì„¤ì‚¬Â·ê°€ìŠ¤ ì¤‘ í•œ ê°€ì§€ë§Œ ì§€ì†ë˜ê¸°ë³´ë‹¤, ìƒí™©ì— ë”°ë¼ ì–‘ìƒì´ ë°”ë€Œë‚˜ìš”?", layerKey:"L1" },
    { id:"L1_3", text:"í•­ìƒì œ ë³µìš© ì´í›„ë¶€í„° ì¥ ë¶ˆí¸ì´ ëˆˆì— ë„ê²Œ ëŠ˜ì—ˆë‹¤ê³  ëŠë¼ì‹œë‚˜ìš”?", layerKey:"L1" },
    { id:"L1_4", text:"íŠ¹ì • ìŒì‹ ë•Œë¬¸ì´ë¼ê¸°ë³´ë‹¤, ì „ë°˜ì ìœ¼ë¡œ ì¥ ìƒíƒœê°€ ë“¤ì‘¥ë‚ ì‘¥í•œ ëŠë‚Œì´ ìˆë‚˜ìš”?", layerKey:"L1" },

    // ë ˆì´ì–´ L2 ë¦¬ë“¬/ìŠ¤íŠ¸ë ˆìŠ¤
    { id:"L2_1", text:"í‰ì†Œ ì–´ê¹¨Â·ëª©ì´ ìì£¼ ë­‰ì¹˜ê±°ë‚˜, í„±ì— í˜ì´ ë“¤ì–´ê°€ëŠ” í¸ì¸ê°€ìš”?", layerKey:"L2" },
    { id:"L2_2", text:"ìˆ˜ë©´ ì‹œê°„ì´ ì¤„ê±°ë‚˜ ìˆ˜ë©´ ì§ˆì´ ë‚˜ìœ ë‚ , ì†Œí™” ìƒíƒœê°€ ë°”ë¡œ ì˜í–¥ì„ ë°›ë‚˜ìš”?", layerKey:"L2" },
    { id:"L2_3", text:"ê¸´ì¥í•˜ë©´ ë°°ê°€ â€˜ê¼¬ë¥´ë¥µâ€™ í•˜ê±°ë‚˜, ê°‘ìê¸° í™”ì¥ì‹¤ì´ ê¸‰í•´ì§€ëŠ” í¸ì¸ê°€ìš”?", layerKey:"L2" },
    { id:"L2_4", text:"ì£¼ë§ì´ë‚˜ íœ´ì‹ê¸°ì—” ë¹„êµì  ë‚«ê³ , ì¼ìƒ ë¦¬ë“¬ì´ ë°”ì ìˆ˜ë¡ ë¶ˆí¸í•´ì§€ë‚˜ìš”?", layerKey:"L2" },

    // ë ˆì´ì–´ L3 í˜ˆë¶€ì¡±/ì‚°ì†Œ
    { id:"L3_1", text:"ì¡°ê¸ˆë§Œ ì›€ì§ì´ê±°ë‚˜ ì‹ì‚¬ í›„ì— ì‰½ê²Œ ìˆ¨ì´ ì°¨ê±°ë‚˜ ê¸°ìš´ì´ ë–¨ì–´ì§€ë‚˜ìš”?", layerKey:"L3" },
    { id:"L3_2", text:"ì†ë°œì´ ìì£¼ ì°¨ê±°ë‚˜, í˜ˆì•¡ìˆœí™˜ì´ ì˜ ì•ˆ ë˜ëŠ” ëŠë‚Œì´ ìˆë‚˜ìš”?", layerKey:"L3" },
    { id:"L3_3", text:"ì‹ì‚¬ëŸ‰ì´ë‚˜ ì˜ì–‘ ì„­ì·¨ëŠ” ì ì§€ ì•Šì€ë°, ì—ë„ˆì§€ê°€ ì˜ ì°¨ì˜¤ë¥´ì§€ ì•Šë‚˜ìš”?", layerKey:"L3" },
    { id:"L3_4", text:"ì–´ì§€ëŸ¼Â·ë©í•¨Â·ì§‘ì¤‘ë ¥ ì €í•˜ê°€ í•¨ê»˜ ëŠê»´ì§€ëŠ” í¸ì¸ê°€ìš”?", layerKey:"L3" },

    // ë ˆì´ì–´ L4 íšŒë³µ ì €í•˜(ë§Œì„±ì—¼ì¦/íšŒë³µë ¥ ì €í•˜ì— ê°€ê¹Œì›€)
    { id:"L4_1", text:"ëª¸ì´ ì˜ˆì „ë³´ë‹¤ ì‰½ê²Œ ë¶“ê±°ë‚˜, ë¬µì§í•˜ê³  ë¬´ê±°ìš´ ëŠë‚Œì´ ìì£¼ ë“œë‚˜ìš”?", layerKey:"L4" },
    { id:"L4_2", text:"ì¶©ë¶„íˆ ì‰¬ì–´ë„ ëª¸ì´ ê°œìš´í•´ì§€ì§€ ì•Šê³ , í”¼ë¡œê°€ ê¸°ë³¸ ìƒíƒœì²˜ëŸ¼ ëŠê»´ì§€ë‚˜ìš”?", layerKey:"L4" },
    { id:"L4_3", text:"íŠ¹ì • í•œ ë¶€ìœ„ë§Œì´ ì•„ë‹ˆë¼, ë¶ˆí¸í•¨ì´ ì—¬ê¸°ì €ê¸° ì˜®ê²¨ ë‹¤ë‹ˆëŠ” ëŠë‚Œì´ ìˆë‚˜ìš”?", layerKey:"L4" },
    { id:"L4_4", text:"ìµœê·¼ 1~3ê°œì›” ë™ì•ˆ â€˜ì†Œí™”/ë°°ë³€/í”¼ë¡œâ€™ ê°™ì€ ë¶ˆí¸ì´ ì™„ì „íˆ ì‚¬ë¼ì§„ ê¸°ê°„ì´ ê±°ì˜ ì—†ì—ˆë‚˜ìš”?", layerKey:"L4" },
  ];

  // âœ… íƒ€ì… ê²°ê³¼ ë¬¸êµ¬(í™•ì¥ ë²„ì „)
  const TYPE_COPY = {
    A: {
      title: "ğŸ…° ìœ„ ë¬¸ì œ íƒ€ì…",
      explain:
        "ì§€ê¸ˆì€ ìœ„ê°€ ìŒì‹ì„ ì²˜ë¦¬í•˜ëŠ” í˜ì´ ë¶€ì¡±í•´ ë³´ì´ëŠ” ìƒíƒœì˜ˆìš”. ê·¸ë˜ì„œ ìŒì‹ì„ ë¨¹ìœ¼ë©´ ë°”ë¡œ ë”ë¶€ë£©í•´ì§€ê±°ë‚˜, ì²´í•œ ëŠë‚Œì´ ì˜¤ë˜ ë‚¨ëŠ” í¸ì´ì—ìš”. ìœ„ê°€ ì§€ì¹˜ë©´ ìŒì‹ì´ ì•„ë˜ë¡œ ë‚´ë ¤ê°€ëŠ” ì†ë„ë„ ëŠë ¤ì ¸ì„œ, ë‹µë‹µí•¨ì´ ë” í¬ê²Œ ëŠê»´ì§ˆ ìˆ˜ ìˆì–´ìš”.",
      empathy:
        "â€œì¡°ê¸ˆë§Œ ë¨¹ì–´ë„ ì†ì´ ë¶ˆí¸í•´ìš”.â€ â€œë°¥ ë¨¹ê³  ë‚˜ë©´ ì•„ë¬´ê²ƒë„ í•˜ê¸° ì‹«ì–´ìš”.â€ ì´ëŸ° ëŠë‚Œ, ìµìˆ™í•˜ì§€ ì•Šìœ¼ì„¸ìš”?",
      curiosity:
        "ìœ„ê°€ ì•½í•´ì§„ ì´ìœ ëŠ” ì‚¬ëŒë§ˆë‹¤ ë‹¬ë¼ìš”. ë‹¨ìˆœíˆ ì†Œí™”ë§Œì˜ ë¬¸ì œì¼ ìˆ˜ë„ ìˆê³ , ëª¸ ì „ì²´ ì»¨ë””ì…˜ì´ ë¨¼ì € ë–¨ì–´ì§„ ì‹ í˜¸ì¼ ìˆ˜ë„ ìˆì–´ìš”."
    },

    B: {
      title: "ğŸ…± ì¥ ë¬¸ì œ íƒ€ì…",
      explain:
        "ì¥ ê¸°ëŠ¥ì´ ë§¤ë„ëŸ½ê²Œ ì›€ì§ì´ì§€ ì•ŠëŠ” ìƒíƒœì˜ˆìš”. ê·¸ë˜ì„œ ë³€ë¹„, ê°€ìŠ¤, ì”ë³€ê°ì²˜ëŸ¼ ë°°ê°€ ëŠ˜ ê°œìš´í•˜ì§€ ì•Šì€ ëŠë‚Œì´ ë°˜ë³µë¼ìš”. ì¥ì´ ëŠë ¤ì§€ë©´ ê°€ìŠ¤ê°€ ì‰½ê²Œ ì°¨ê³ , ë°°ê°€ ë¬µì§í•´ì§€ë©´ì„œ í•˜ë£¨ ì»¨ë””ì…˜ê¹Œì§€ ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆì–´ìš”.",
      empathy:
        "â€œí™”ì¥ì‹¤ì„ ë‹¤ë…€ì™€ë„ ì‹œì›í•˜ì§€ ì•Šì•„ìš”.â€ â€œë°°ì— ê°€ìŠ¤ê°€ ìì£¼ ì°¨ìš”.â€ ì´ëŸ° ë¶ˆí¸í•¨ì´ ê³„ì†ë˜ê³  ìˆì§€ ì•Šë‚˜ìš”?",
      curiosity:
        "ì¥ì´ ë¶ˆí¸í•œ ì´ìœ ëŠ” í•œ ê°€ì§€ë¡œë§Œ ì„¤ëª…ë˜ê¸° ì–´ë ¤ì›Œìš”. ì¥ ì† í™˜ê²½, ìƒí™œ ë¦¬ë“¬, ëª¸ì˜ íšŒë³µ ìƒíƒœê°€ í•¨ê»˜ ì˜í–¥ì„ ì£¼ëŠ” ê²½ìš°ê°€ ë§ì•„ìš”."
    },

    C: {
      title: "ğŸ…² ì‹ ê²½ì„± íƒ€ì…",
      explain:
        "ëª¸ì´ í•­ìƒ ê¸´ì¥ ëª¨ë“œì— ê°€ê¹Œìš´ ìƒíƒœì˜ˆìš”. ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ë°›ê±°ë‚˜ ì‹ ê²½ ì“°ëŠ” ì¼ì´ ìˆìœ¼ë©´ ë°°ë‚˜ ì†ë¶€í„° ë¨¼ì € ë°˜ì‘í•˜ëŠ” í¸ì´ì—ìš”. ì´ëŸ´ ë• ë°° ìì²´ë³´ë‹¤, ëª¸ì˜ ê¸´ì¥ê³¼ ë¦¬ë“¬ì„ í•¨ê»˜ í’€ì–´ì¤˜ì•¼ í¸í•´ì§€ëŠ” ê²½ìš°ê°€ ë§ì•„ìš”.",
      empathy:
        "â€œì¤‘ìš”í•œ ë‚ ë§Œ ë˜ë©´ ë°°ê°€ ë” ë¶ˆí¸í•´ìš”.â€ â€œë§ˆìŒì´ í¸í•˜ì§€ ì•Šìœ¼ë©´ ì†Œí™”ë„ ì•ˆ ë¼ìš”.â€ ì´ëŸ° ê²½í—˜, í•œ ë²ˆì¯¤ ìˆìœ¼ì…¨ì„ ê±°ì˜ˆìš”.",
      curiosity:
        "ì´ëŸ° ê²½ìš°ëŠ” ìŒì‹ì´ë‚˜ ì¥ë§Œì˜ ë¬¸ì œê°€ ì•„ë‹ˆë¼, ëª¸ ì „ì²´ê°€ ì‰¬ì§€ ëª»í•˜ê³  ìˆë‹¤ëŠ” ì‹ í˜¸ì¼ ìˆ˜ ìˆì–´ìš”."
    },

    MIX: {
      title: "ğŸ”€ í˜¼í•©í˜• ê²½í–¥",
      explain:
        "í•œ ê°€ì§€ ì´ìœ ë§Œìœ¼ë¡œ ì„¤ëª…ë˜ê¸°ë³´ë‹¤ëŠ”, ì—¬ëŸ¬ ê°€ì§€ ì‹ í˜¸ê°€ í•¨ê»˜ ì„ì—¬ ìˆëŠ” ìƒíƒœë¡œ ë³´ì—¬ìš”. ê·¸ë˜ì„œ ì–´ë–¤ ë‚ ì€ ì¥ì´ ë¬¸ì œì²˜ëŸ¼ ëŠê»´ì§€ê³ , ì–´ë–¤ ë‚ ì€ ìœ„ê°€ ë” ë¶ˆí¸í•˜ê±°ë‚˜, ìŠ¤íŠ¸ë ˆìŠ¤ê°€ ë” í¬ê²Œ ëŠê»´ì§ˆ ìˆ˜ ìˆì–´ìš”. ì´ëŸ° ê²½ìš°ëŠ” ë­˜ ë” ë§ì´ í•˜ê¸°ë³´ë‹¤, ë‚´ ëª¸ì— ë§ëŠ” ìˆœì„œë¥¼ ë‹¤ì‹œ ì¡ëŠ” ê²Œ ë” ë¹ ë¥´ê²Œ ë„ì›€ì´ ë©ë‹ˆë‹¤.",
      empathy:
        "ì´ê²ƒì €ê²ƒ ë‹¤ í•´ë´¤ëŠ”ë°, ê·¸ë•Œë¿ì´ì—ˆë˜ ê²½í—˜ì´ ìˆì§€ ì•Šìœ¼ì‹ ê°€ìš”?",
      curiosity:
        "ì§€ê¸ˆ ë‚´ ëª¸ì—ëŠ” ë¬´ì—‡ë¶€í„° ì •ë¦¬í•˜ëŠ” ê²Œ ë§ì„ì§€, ìˆœì„œë¥¼ ë‹¤ì‹œ ì‚´í´ë³¼ í•„ìš”ê°€ ìˆì–´ ë³´ì—¬ìš”."
    }
  };

  const LAYER_COPY = {
    L1: {
      name: "ğŸŒ± ì¥ë‚´ í™˜ê²½",
      short: "ë°° ì† í™˜ê²½ì´ ê¹”ë”í•˜ì§€ ì•Šì€ ìƒíƒœë¡œ ë³´ì—¬ìš”.",
      explain: "ì¢‹ì€ ê· ê³¼ ë‚˜ìœ ê· ì˜ ê· í˜•ì´ ë§ì§€ ì•Šìœ¼ë©´ ì¥ì´ ì˜ˆë¯¼í•˜ê²Œ ë°˜ì‘í•  ìˆ˜ ìˆì–´ìš”.",
      empathy: "ìœ ì‚°ê· ì„ ë¨¹ì„ ë• ê´œì°®ë‹¤ê°€ ëŠìœ¼ë©´ ë‹¤ì‹œ ë¶ˆí¸í•´ì§„ ì  ìˆì§€ ì•Šìœ¼ì„¸ìš”?"
    },
    L2: {
      name: "â° ìƒí™œ ë¦¬ë“¬/ìŠ¤íŠ¸ë ˆìŠ¤",
      short: "ëª¸ì´ ìƒí™œ ë¦¬ë“¬ì— ë§ì´ ì˜í–¥ì„ ë°›ëŠ” ìƒíƒœì˜ˆìš”.",
      explain: "ì ì„ ëª» ìê±°ë‚˜ ë°”ìœ ë‚ ì—ëŠ” ë°°ë‚˜ ì†ì´ ë°”ë¡œ ë°˜ì‘í•˜ëŠ” í¸ì´ì—ìš”.",
      empathy: "í‰ì¼ì—” í˜ë“¤ê³ , ì‰¬ëŠ” ë‚ ì—” ì¡°ê¸ˆ ë‚˜ì•„ì§€ëŠ” ëŠë‚Œ, ìµìˆ™í•˜ì£ ?"
    },
    L3: {
      name: "ğŸ©¸ ê¸°ìš´/ì—ë„ˆì§€ ë¶€ì¡±",
      short: "ëª¸ì— ê¸°ìš´ì´ ì¶©ë¶„íˆ ì°¨ ìˆì§€ ì•Šì€ ìƒíƒœì˜ˆìš”.",
      explain: "ê·¸ë˜ì„œ ì†Œí™”ë„ ëŠë ¤ì§€ê³ , ì¡°ê¸ˆë§Œ ì›€ì§ì—¬ë„ ì‰½ê²Œ í”¼ê³¤í•´ì§ˆ ìˆ˜ ìˆì–´ìš”.",
      empathy: "â€œë°¥ì€ ë¨¹ëŠ”ë° ê¸°ìš´ì´ ì•ˆ ë‚˜ìš”.â€ ì´ëŸ° ë§, ìì£¼ í•˜ì‹œì§€ ì•Šë‚˜ìš”?"
    },
    L4: {
      name: "ğŸ”¥ íšŒë³µì´ ëŠë¦° ìƒíƒœ",
      short: "ëª¸ì´ ì‰¬ì–´ë„ ì˜ íšŒë³µë˜ì§€ ì•ŠëŠ” ìƒíƒœì˜ˆìš”.",
      explain: "ì˜ ë¶“ê³ , ë¬´ê²ê³ , í•­ìƒ í”¼ê³¤í•œ ëŠë‚Œì´ ê¸°ë³¸ì²˜ëŸ¼ ëŠê»´ì§ˆ ìˆ˜ ìˆì–´ìš”.",
      empathy: "ì˜ˆì „ë³´ë‹¤ íšŒë³µì´ ëŠë ¤ì¡Œë‹¤ê³  ëŠë¼ì‹  ì  ìˆì§€ ì•Šìœ¼ì‹ ê°€ìš”?"
    }
  };

  function renderQuestions(){
    qList.innerHTML = "";
    questions.forEach((q, idx) => {
      const box = document.createElement("div");
      box.className = "q";

      const title = document.createElement("div");
      title.className = "q-title";
      title.textContent = `${idx+1}. ${q.text}`;

      const row = document.createElement("div");
      row.className = "yn";

      const yesBtn = document.createElement("button");
      yesBtn.className = "btn";
      yesBtn.type = "button";
      yesBtn.textContent = "ì˜ˆ";

      const noBtn = document.createElement("button");
      noBtn.className = "btn";
      noBtn.type = "button";
      noBtn.textContent = "ì•„ë‹ˆì˜¤";

      function paint(){
        yesBtn.classList.remove("selected-yes");
        noBtn.classList.remove("selected-no");
        const v = answers.get(q.id);
        if(v === true) yesBtn.classList.add("selected-yes");
        if(v === false) noBtn.classList.add("selected-no");
      }

      yesBtn.addEventListener("click", () => { answers.set(q.id, true); paint(); });
      noBtn.addEventListener("click", () => { answers.set(q.id, false); paint(); });

      row.appendChild(yesBtn);
      row.appendChild(noBtn);
      box.appendChild(title);
      box.appendChild(row);
      qList.appendChild(box);

      paint();
    });
  }

  function allAnswered(){
    return questions.every(q => answers.has(q.id));
  }

  function score(){
    const type = { A:0, B:0, C:0 };
    const layer = { L1:0, L2:0, L3:0, L4:0 };

    questions.forEach(q => {
      const v = answers.get(q.id) === true;
      if(!v) return;
      if(q.typeKey) type[q.typeKey] += 1;
      if(q.layerKey) layer[q.layerKey] += 1;
    });

    return { type, layer };
  }

  function pickMainType(typeScores){
    const entries = Object.entries(typeScores).sort((a,b)=>b[1]-a[1]);
    const max = entries[0][1];
    const top = entries.filter(e=>e[1]===max).map(e=>e[0]);

    if(max === 0) return { key:"MIX", title: TYPE_COPY.MIX.title, topKeys: top };
    if(top.length === 1) {
      const k = top[0];
      return { key:k, title: TYPE_COPY[k].title, topKeys: top };
    }
    return { key:"MIX", title: TYPE_COPY.MIX.title, topKeys: top };
  }

  function pickLayers(layerScores){
    const entries = Object.entries(layerScores).map(([k,v])=>({k,v})).sort((a,b)=>b.v-a.v);
    const strong = entries.filter(x=>x.v>=3);
    if(strong.length>=2) return strong.slice(0,2);
    if(strong.length===1) return strong;
    const mid = entries.filter(x=>x.v===2);
    if(mid.length>=1) return [mid[0]];
    return [];
  }

  function renderScoreUI(typeScores){
    // íƒ€ì… ë¬¸í•­ ìˆ˜ ê³ ì •: A=3, B=3, C=2
    const maxType = { A:3, B:3, C:2 };
    const typeLabel = {
      A: "ìœ„ ìª½(ì‹í›„ ë”ë¶€ë£©/ì²´í•¨)",
      B: "ì¥ ìª½(ë³€ë¹„/ê°€ìŠ¤/ì”ë³€ê°)",
      C: "ê¸´ì¥ ì˜í–¥(ìŠ¤íŠ¸ë ˆìŠ¤/ë¦¬ë“¬)"
    };

    const sorted = Object.entries(typeScores).sort((a,b)=>b[1]-a[1]);
    const topKey = sorted[0][0];
    const secondKey = sorted[1][0];

    document.getElementById("scoreSummary").textContent =
      `ê°€ì¥ ê°•í•œ ìª½ì€ â€œ${typeLabel[topKey]}â€ì´ê³ , ê·¸ë‹¤ìŒì€ â€œ${typeLabel[secondKey]}â€ ìª½ì´ì—ìš”.`;

    const barsEl = document.getElementById("scoreBars");
    barsEl.innerHTML = "";

    function barRow(title, value, max){
      const pct = Math.round((value / max) * 100);
      const wrap = document.createElement("div");
      wrap.innerHTML = `
        <div style="display:flex; justify-content:space-between; gap:10px; margin-bottom:6px;">
          <div style="font-weight:800;">${title}</div>
          <div class="hint">${value}/${max}</div>
        </div>
        <div style="height:10px; border-radius:999px; background:#0b1220; border:1px solid #263042; overflow:hidden;">
          <div style="height:100%; width:${pct}%; background:rgba(34,197,94,.65);"></div>
        </div>
      `;
      barsEl.appendChild(wrap);
    }

    barRow(typeLabel.A, typeScores.A, maxType.A);
    barRow(typeLabel.B, typeScores.B, maxType.B);
    barRow(typeLabel.C, typeScores.C, maxType.C);
  }

  async function submitToWebhook(payload){
    if(!WEBHOOK_URL) return;

    try{
      await fetch(WEBHOOK_URL, {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "text/plain;charset=utf-8" },
        body: JSON.stringify(payload)
      });
      saveHint.textContent = "âœ… ì‘ë‹µì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤. (êµ¬ê¸€ì‹œíŠ¸ì— ì €ì¥ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”)";
    } catch(e){
      saveHint.textContent = "âš ï¸ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (ë„¤íŠ¸ì›Œí¬/ê¶Œí•œ ë¬¸ì œ)";
    }
  }

  function buildResult(){
    const { type, layer } = score();
    const main = pickMainType(type);
    const showLayers = pickLayers(layer);

    // ì ìˆ˜ UI
    renderScoreUI(type);

    // íƒ€ì… ê²°ê³¼(ì„¤ëª…/ê³µê°/ê¶ê¸ˆì¦)
    const copy = TYPE_COPY[main.key] || TYPE_COPY.MIX;
    mainTypeTitle.textContent = `ë‚´ ìƒíƒœ ìš”ì•½: ${copy.title}`;
    typeExplain.textContent = copy.explain;
    typeEmpathy.textContent = copy.empathy;
    typeCuriosity.textContent = copy.curiosity;

    // ë ˆì´ì–´ íƒœê·¸ + ì‰¬ìš´ ì„¤ëª…
    layerTags.innerHTML = "";
    layerDetails.innerHTML = "";

    if(showLayers.length){
      showLayers.forEach(x => {
        const meta = LAYER_COPY[x.k];
        const t = document.createElement("div");
        t.className = "tag";
        t.innerHTML = `<strong>${meta.name}</strong> Â· ${x.v}/4`;
        layerTags.appendChild(t);

        const d = document.createElement("div");
        d.style.marginBottom = "12px";
        d.innerHTML = `
          <div style="font-weight:900; margin-bottom:6px;">${meta.name}</div>
          <div style="color:#e5e7eb; margin-bottom:6px;">${meta.short}</div>
          <div class="hint" style="margin-bottom:6px;">${meta.explain}</div>
          <div class="hint">ğŸ¤ ${meta.empathy}</div>
        `;
        layerDetails.appendChild(d);
      });
    } else {
      const t = document.createElement("div");
      t.className = "tag";
      t.innerHTML = `<strong>ì¶”ê°€ í™•ì¸</strong> Â· ë³µí•© ê°€ëŠ¥ì„±`;
      layerTags.appendChild(t);
      layerDetails.innerHTML = `<div class="hint">ëšœë ·í•˜ê²Œ í•œ ê°€ì§€ë¡œë§Œ ì„¤ëª…ë˜ê¸°ë³´ë‹¤, ìƒí™œë¦¬ë“¬/ì‹ì‚¬íŒ¨í„´/ì»¨ë””ì…˜ì´ í•¨ê»˜ ì˜í–¥ì„ ì£¼ëŠ” ê²½ìš°ê°€ ë§ì•„ìš”. ìƒë‹´ì—ì„œ ìš°ì„ ìˆœìœ„ë¥¼ ê°™ì´ ì •ë¦¬í•˜ë©´ í›¨ì”¬ ì‰¬ì›Œì§‘ë‹ˆë‹¤.</div>`;
    }

    // ìƒë‹´ìš© ë³µì‚¬ í…ìŠ¤íŠ¸
    const strongLayerNames =
      showLayers.map(x => `${LAYER_COPY[x.k].name.replace(/^[^ ]+ /,'')}(${x.v}/4)`).join(", ") || "ëšœë ·í•œ ë‹¨ì¼ ë ˆì´ì–´ ì—†ìŒ";
    const resultSummary = `${copy.title.replace(/^.+ /,'')} / ì°¸ê³ : ${strongLayerNames}`;

    copyText.value =
`[ë¬´ë£Œ ì²´í¬ ê²°ê³¼ ê¸°ë°˜ ìƒë‹´ ìš”ì²­]
(ì¹´í†¡ ë˜ëŠ” ë¬¸ìë¡œ ì•„ë˜ ë‚´ìš©ì„ ë³´ë‚´ì£¼ì„¸ìš”)
1) ì„±í•¨: ${userInfo.name}
2) ì—°ë½ì²˜: ${userInfo.phone}
3) ê²°ê³¼ ìš”ì•½: ${resultSummary}
4) ê°€ì¥ ë¶ˆí¸í•œ ì¦ìƒ 1ê°€ì§€: (ì˜ˆ: ë³€ë¹„/ê°€ìŠ¤/ë”ë¶€ë£©/ì†ì“°ë¦¼ ë“±)
5) í†µí™” ê°€ëŠ¥ ìš”ì¼/ì‹œê°„: (ì˜ˆ: ì›”/í™”/ëª©/ê¸ˆ ì €ë… 8~10ì‹œ ì¤‘ ê°€ëŠ¥ ì‹œê°„)`;

    // ì €ì¥ payload
    const payload = {
      ts: new Date().toISOString(),
      user: userInfo,
      scores: { type, layer },
      mainType: main,
      shownLayers: showLayers
    };
    submitToWebhook(payload);
  }

  // ì´ë²¤íŠ¸
  startBtn.addEventListener("click", () => {
    if(!validateInfo()) return;
    errUnanswered.style.display = "none";
    renderQuestions();
    show(screenQuestions);
  });

  backBtn.addEventListener("click", () => show(screenInfo));

  resultBtn.addEventListener("click", () => {
    if(!allAnswered()){
      errUnanswered.style.display = "block";
      return;
    }
    errUnanswered.style.display = "none";
    saveHint.textContent = "";
    buildResult();
    show(screenResult);
  });

  copyBtn.addEventListener("click", async () => {
    try{
      await navigator.clipboard.writeText(copyText.value);
      copyBtn.textContent = "ë³µì‚¬ë¨!";
      setTimeout(()=> copyBtn.textContent="ë³µì‚¬í•˜ê¸°", 1100);
    } catch(e){
      copyText.select();
      document.execCommand("copy");
      copyBtn.textContent = "ë³µì‚¬ë¨!";
      setTimeout(()=> copyBtn.textContent="ë³µì‚¬í•˜ê¸°", 1100);
    }
  });

  restartBtn.addEventListener("click", () => {
    answers.clear();
    userInfo = {};
    nameEl.value = "";
    phoneEl.value = "";
    genderEl.value = "";
    ageEl.value = "";
    errName.style.display = "none";
    errPhone.style.display = "none";
    saveHint.textContent = "";
    show(screenInfo);
  });

  // ì´ˆê¸°
  show(screenInfo);
})();
</script>
</body>
</html>
